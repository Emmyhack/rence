import{g as se,c as g}from"./vendor-d152ed12.js";import{r as xe}from"./web3-735b79eb.js";var U={exports:{}},A=typeof Reflect=="object"?Reflect:null,V=A&&typeof A.apply=="function"?A.apply:function(t,n,o){return Function.prototype.apply.call(t,n,o)},x;A&&typeof A.ownKeys=="function"?x=A.ownKeys:Object.getOwnPropertySymbols?x=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:x=function(t){return Object.getOwnPropertyNames(t)};function Be(e){console&&console.warn&&console.warn(e)}var oe=Number.isNaN||function(t){return t!==t};function h(){h.init.call(this)}U.exports=h;U.exports.once=Se;h.EventEmitter=h;h.prototype._events=void 0;h.prototype._eventsCount=0;h.prototype._maxListeners=void 0;var k=10;function B(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return k},set:function(e){if(typeof e!="number"||e<0||oe(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");k=e}});h.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};h.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||oe(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function ie(e){return e._maxListeners===void 0?h.defaultMaxListeners:e._maxListeners}h.prototype.getMaxListeners=function(){return ie(this)};h.prototype.emit=function(t){for(var n=[],o=1;o<arguments.length;o++)n.push(arguments[o]);var i=t==="error",u=this._events;if(u!==void 0)i=i&&u.error===void 0;else if(!i)return!1;if(i){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var l=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw l.context=a,l}var y=u[t];if(y===void 0)return!1;if(typeof y=="function")V(y,this,n);else for(var T=y.length,j=le(y,T),o=0;o<T;++o)V(j[o],this,n);return!0};function ae(e,t,n,o){var i,u,a;if(B(n),u=e._events,u===void 0?(u=e._events=Object.create(null),e._eventsCount=0):(u.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),u=e._events),a=u[t]),a===void 0)a=u[t]=n,++e._eventsCount;else if(typeof a=="function"?a=u[t]=o?[n,a]:[a,n]:o?a.unshift(n):a.push(n),i=ie(e),i>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,Be(l)}return e}h.prototype.addListener=function(t,n){return ae(this,t,n,!1)};h.prototype.on=h.prototype.addListener;h.prototype.prependListener=function(t,n){return ae(this,t,n,!0)};function je(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function fe(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=je.bind(o);return i.listener=n,o.wrapFn=i,i}h.prototype.once=function(t,n){return B(n),this.on(t,fe(this,t,n)),this};h.prototype.prependOnceListener=function(t,n){return B(n),this.prependListener(t,fe(this,t,n)),this};h.prototype.removeListener=function(t,n){var o,i,u,a,l;if(B(n),i=this._events,i===void 0)return this;if(o=i[t],o===void 0)return this;if(o===n||o.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,o.listener||n));else if(typeof o!="function"){for(u=-1,a=o.length-1;a>=0;a--)if(o[a]===n||o[a].listener===n){l=o[a].listener,u=a;break}if(u<0)return this;u===0?o.shift():Ce(o,u),o.length===1&&(i[t]=o[0]),i.removeListener!==void 0&&this.emit("removeListener",t,l||n)}return this};h.prototype.off=h.prototype.removeListener;h.prototype.removeAllListeners=function(t){var n,o,i;if(o=this._events,o===void 0)return this;if(o.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):o[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete o[t]),this;if(arguments.length===0){var u=Object.keys(o),a;for(i=0;i<u.length;++i)a=u[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=o[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function ue(e,t,n){var o=e._events;if(o===void 0)return[];var i=o[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?De(i):le(i,i.length)}h.prototype.listeners=function(t){return ue(this,t,!0)};h.prototype.rawListeners=function(t){return ue(this,t,!1)};h.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):ce.call(e,t)};h.prototype.listenerCount=ce;function ce(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}h.prototype.eventNames=function(){return this._eventsCount>0?x(this._events):[]};function le(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}function Ce(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function De(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function Se(e,t){return new Promise(function(n,o){function i(a){e.removeListener(t,u),o(a)}function u(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}he(e,t,u,{once:!0}),t!=="error"&&Ne(e,i,{once:!0})})}function Ne(e,t,n){typeof e.on=="function"&&he(e,"error",t,n)}function he(e,t,n,o){if(typeof e.on=="function")o.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(u){o.once&&e.removeEventListener(t,i),n(u)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var de=U.exports;const pt=se(de),Me=e=>JSON.stringify(e,(t,n)=>typeof n=="bigint"?n.toString()+"n":n),Ie=e=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=e.replace(t,'$1"$2n"$3');return JSON.parse(n,(o,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function Ue(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return Ie(e)}catch{return e}}function G(e){return typeof e=="string"?e:Me(e)||""}const Fe="PARSE_ERROR",He="INVALID_REQUEST",qe="METHOD_NOT_FOUND",Je="INVALID_PARAMS",pe="INTERNAL_ERROR",F="SERVER_ERROR",$e=[-32700,-32600,-32601,-32602,-32603],L={[Fe]:{code:-32700,message:"Parse error"},[He]:{code:-32600,message:"Invalid Request"},[qe]:{code:-32601,message:"Method not found"},[Je]:{code:-32602,message:"Invalid params"},[pe]:{code:-32603,message:"Internal error"},[F]:{code:-32e3,message:"Server error"}},ye=F;function Ve(e){return $e.includes(e)}function z(e){return Object.keys(L).includes(e)?L[e]:L[ye]}function ke(e){const t=Object.values(L).find(n=>n.code===e);return t||L[ye]}function Ge(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${t}`):e}var ze={},w={},W;function We(){if(W)return w;W=1,Object.defineProperty(w,"__esModule",{value:!0}),w.isBrowserCryptoAvailable=w.getSubtleCrypto=w.getBrowerCrypto=void 0;function e(){return(g===null||g===void 0?void 0:g.crypto)||(g===null||g===void 0?void 0:g.msCrypto)||{}}w.getBrowerCrypto=e;function t(){const o=e();return o.subtle||o.webkitSubtle}w.getSubtleCrypto=t;function n(){return!!e()&&!!t()}return w.isBrowserCryptoAvailable=n,w}var E={},K;function Ke(){if(K)return E;K=1,Object.defineProperty(E,"__esModule",{value:!0}),E.isBrowser=E.isNode=E.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}E.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}E.isNode=t;function n(){return!e()&&!t()}return E.isBrowser=n,E}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=xe;t.__exportStar(We(),e),t.__exportStar(Ke(),e)})(ze);function ve(e=3){const t=Date.now()*Math.pow(10,e),n=Math.floor(Math.random()*Math.pow(10,e));return t+n}function yt(e=6){return BigInt(ve(e))}function vt(e,t,n){return{id:n||ve(),jsonrpc:"2.0",method:e,params:t}}function bt(e,t){return{id:e,jsonrpc:"2.0",result:t}}function Xe(e,t,n){return{id:e,jsonrpc:"2.0",error:Qe(t,n)}}function Qe(e,t){return typeof e>"u"?z(pe):(typeof e=="string"&&(e=Object.assign(Object.assign({},z(F)),{message:e})),typeof t<"u"&&(e.data=t),Ve(e.code)&&(e=ke(e.code)),e)}class be{}let mt=class extends be{constructor(t){super()}};class Ze extends be{constructor(){super()}}class wt extends Ze{constructor(t){super()}}const Ye="^https?:",et="^wss?:";function tt(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function me(e,t){const n=tt(e);return typeof n>"u"?!1:new RegExp(t).test(n)}function X(e){return me(e,Ye)}function Et(e){return me(e,et)}function _t(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function ge(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function Rt(e){return ge(e)&&"method"in e}function Ot(e){return ge(e)&&(rt(e)||nt(e))}function rt(e){return"result"in e}function nt(e){return"error"in e}var I={exports:{}};(function(e,t){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof g<"u"&&g,o=function(){function u(){this.fetch=!1,this.DOMException=n.DOMException}return u.prototype=n,new u}();(function(u){(function(a){var l=typeof u<"u"&&u||typeof self<"u"&&self||typeof g<"u"&&g||{},y={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function T(r){return r&&DataView.prototype.isPrototypeOf(r)}if(y.arrayBuffer)var j=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],we=ArrayBuffer.isView||function(r){return r&&j.indexOf(Object.prototype.toString.call(r))>-1};function O(r){if(typeof r!="string"&&(r=String(r)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(r)||r==="")throw new TypeError('Invalid character in header field name: "'+r+'"');return r.toLowerCase()}function C(r){return typeof r!="string"&&(r=String(r)),r}function D(r){var s={next:function(){var f=r.shift();return{done:f===void 0,value:f}}};return y.iterable&&(s[Symbol.iterator]=function(){return s}),s}function v(r){this.map={},r instanceof v?r.forEach(function(s,f){this.append(f,s)},this):Array.isArray(r)?r.forEach(function(s){if(s.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+s.length);this.append(s[0],s[1])},this):r&&Object.getOwnPropertyNames(r).forEach(function(s){this.append(s,r[s])},this)}v.prototype.append=function(r,s){r=O(r),s=C(s);var f=this.map[r];this.map[r]=f?f+", "+s:s},v.prototype.delete=function(r){delete this.map[O(r)]},v.prototype.get=function(r){return r=O(r),this.has(r)?this.map[r]:null},v.prototype.has=function(r){return this.map.hasOwnProperty(O(r))},v.prototype.set=function(r,s){this.map[O(r)]=C(s)},v.prototype.forEach=function(r,s){for(var f in this.map)this.map.hasOwnProperty(f)&&r.call(s,this.map[f],f,this)},v.prototype.keys=function(){var r=[];return this.forEach(function(s,f){r.push(f)}),D(r)},v.prototype.values=function(){var r=[];return this.forEach(function(s){r.push(s)}),D(r)},v.prototype.entries=function(){var r=[];return this.forEach(function(s,f){r.push([f,s])}),D(r)},y.iterable&&(v.prototype[Symbol.iterator]=v.prototype.entries);function S(r){if(!r._noBody){if(r.bodyUsed)return Promise.reject(new TypeError("Already read"));r.bodyUsed=!0}}function H(r){return new Promise(function(s,f){r.onload=function(){s(r.result)},r.onerror=function(){f(r.error)}})}function Ee(r){var s=new FileReader,f=H(s);return s.readAsArrayBuffer(r),f}function _e(r){var s=new FileReader,f=H(s),d=/charset=([A-Za-z0-9_-]+)/.exec(r.type),p=d?d[1]:"utf-8";return s.readAsText(r,p),f}function Re(r){for(var s=new Uint8Array(r),f=new Array(s.length),d=0;d<s.length;d++)f[d]=String.fromCharCode(s[d]);return f.join("")}function q(r){if(r.slice)return r.slice(0);var s=new Uint8Array(r.byteLength);return s.set(new Uint8Array(r)),s.buffer}function J(){return this.bodyUsed=!1,this._initBody=function(r){this.bodyUsed=this.bodyUsed,this._bodyInit=r,r?typeof r=="string"?this._bodyText=r:y.blob&&Blob.prototype.isPrototypeOf(r)?this._bodyBlob=r:y.formData&&FormData.prototype.isPrototypeOf(r)?this._bodyFormData=r:y.searchParams&&URLSearchParams.prototype.isPrototypeOf(r)?this._bodyText=r.toString():y.arrayBuffer&&y.blob&&T(r)?(this._bodyArrayBuffer=q(r.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):y.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(r)||we(r))?this._bodyArrayBuffer=q(r):this._bodyText=r=Object.prototype.toString.call(r):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof r=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(r)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var r=S(this);if(r)return r;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var r=S(this);return r||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(y.blob)return this.blob().then(Ee);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var r=S(this);if(r)return r;if(this._bodyBlob)return _e(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(Re(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(Le)}),this.json=function(){return this.text().then(JSON.parse)},this}var Oe=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function Ae(r){var s=r.toUpperCase();return Oe.indexOf(s)>-1?s:r}function _(r,s){if(!(this instanceof _))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');s=s||{};var f=s.body;if(r instanceof _){if(r.bodyUsed)throw new TypeError("Already read");this.url=r.url,this.credentials=r.credentials,s.headers||(this.headers=new v(r.headers)),this.method=r.method,this.mode=r.mode,this.signal=r.signal,!f&&r._bodyInit!=null&&(f=r._bodyInit,r.bodyUsed=!0)}else this.url=String(r);if(this.credentials=s.credentials||this.credentials||"same-origin",(s.headers||!this.headers)&&(this.headers=new v(s.headers)),this.method=Ae(s.method||this.method||"GET"),this.mode=s.mode||this.mode||null,this.signal=s.signal||this.signal||function(){if("AbortController"in l){var c=new AbortController;return c.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&f)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(f),(this.method==="GET"||this.method==="HEAD")&&(s.cache==="no-store"||s.cache==="no-cache")){var d=/([?&])_=[^&]*/;if(d.test(this.url))this.url=this.url.replace(d,"$1_="+new Date().getTime());else{var p=/\?/;this.url+=(p.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})};function Le(r){var s=new FormData;return r.trim().split("&").forEach(function(f){if(f){var d=f.split("="),p=d.shift().replace(/\+/g," "),c=d.join("=").replace(/\+/g," ");s.append(decodeURIComponent(p),decodeURIComponent(c))}}),s}function Te(r){var s=new v,f=r.replace(/\r?\n[\t ]+/g," ");return f.split("\r").map(function(d){return d.indexOf(`
`)===0?d.substr(1,d.length):d}).forEach(function(d){var p=d.split(":"),c=p.shift().trim();if(c){var P=p.join(":").trim();try{s.append(c,P)}catch(M){console.warn("Response "+M.message)}}}),s}J.call(_.prototype);function m(r,s){if(!(this instanceof m))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(s||(s={}),this.type="default",this.status=s.status===void 0?200:s.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=s.statusText===void 0?"":""+s.statusText,this.headers=new v(s.headers),this.url=s.url||"",this._initBody(r)}J.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})},m.error=function(){var r=new m(null,{status:200,statusText:""});return r.ok=!1,r.status=0,r.type="error",r};var Pe=[301,302,303,307,308];m.redirect=function(r,s){if(Pe.indexOf(s)===-1)throw new RangeError("Invalid status code");return new m(null,{status:s,headers:{location:r}})},a.DOMException=l.DOMException;try{new a.DOMException}catch{a.DOMException=function(s,f){this.message=s,this.name=f;var d=Error(s);this.stack=d.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function N(r,s){return new Promise(function(f,d){var p=new _(r,s);if(p.signal&&p.signal.aborted)return d(new a.DOMException("Aborted","AbortError"));var c=new XMLHttpRequest;function P(){c.abort()}c.onload=function(){var b={statusText:c.statusText,headers:Te(c.getAllResponseHeaders()||"")};p.url.indexOf("file://")===0&&(c.status<200||c.status>599)?b.status=200:b.status=c.status,b.url="responseURL"in c?c.responseURL:b.headers.get("X-Request-URL");var R="response"in c?c.response:c.responseText;setTimeout(function(){f(new m(R,b))},0)},c.onerror=function(){setTimeout(function(){d(new TypeError("Network request failed"))},0)},c.ontimeout=function(){setTimeout(function(){d(new TypeError("Network request timed out"))},0)},c.onabort=function(){setTimeout(function(){d(new a.DOMException("Aborted","AbortError"))},0)};function M(b){try{return b===""&&l.location.href?l.location.href:b}catch{return b}}if(c.open(p.method,M(p.url),!0),p.credentials==="include"?c.withCredentials=!0:p.credentials==="omit"&&(c.withCredentials=!1),"responseType"in c&&(y.blob?c.responseType="blob":y.arrayBuffer&&(c.responseType="arraybuffer")),s&&typeof s.headers=="object"&&!(s.headers instanceof v||l.Headers&&s.headers instanceof l.Headers)){var $=[];Object.getOwnPropertyNames(s.headers).forEach(function(b){$.push(O(b)),c.setRequestHeader(b,C(s.headers[b]))}),p.headers.forEach(function(b,R){$.indexOf(R)===-1&&c.setRequestHeader(R,b)})}else p.headers.forEach(function(b,R){c.setRequestHeader(R,b)});p.signal&&(p.signal.addEventListener("abort",P),c.onreadystatechange=function(){c.readyState===4&&p.signal.removeEventListener("abort",P)}),c.send(typeof p._bodyInit>"u"?null:p._bodyInit)})}return N.polyfill=!0,l.fetch||(l.fetch=N,l.Headers=v,l.Request=_,l.Response=m),a.Headers=v,a.Request=_,a.Response=m,a.fetch=N,Object.defineProperty(a,"__esModule",{value:!0}),a})({})})(o),o.fetch.ponyfill=!0,delete o.fetch.polyfill;var i=n.fetch?n:o;t=i.fetch,t.default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t})(I,I.exports);var st=I.exports;const Q=se(st);var ot=Object.defineProperty,it=Object.defineProperties,at=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,ft=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable,Y=(e,t,n)=>t in e?ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ee=(e,t)=>{for(var n in t||(t={}))ft.call(t,n)&&Y(e,n,t[n]);if(Z)for(var n of Z(t))ut.call(t,n)&&Y(e,n,t[n]);return e},te=(e,t)=>it(e,at(t));const ct={Accept:"application/json","Content-Type":"application/json"},lt="POST",re={headers:ct,method:lt},ne=10;class At{constructor(t,n=!1){if(this.url=t,this.disableProviderPing=n,this.events=new de.EventEmitter,this.isAvailable=!1,this.registering=!1,!X(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const n=G(t),o=await(await Q(this.url,te(ee({},re),{body:n}))).json();this.onPayload({data:o})}catch(n){this.onError(t.id,n)}}async register(t=this.url){if(!X(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((o,i)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),i(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return i(new Error("HTTP connection is missing or invalid"));o()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const n=G({id:1,jsonrpc:"2.0",method:"test",params:[]});await Q(t,te(ee({},re),{body:n}))}this.onOpen()}catch(n){const o=this.parseError(n);throw this.events.emit("register_error",o),this.onClose(),o}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const n=typeof t.data=="string"?Ue(t.data):t.data;this.events.emit("payload",n)}onError(t,n){const o=this.parseError(n),i=o.message||o.toString(),u=Xe(t,i);this.events.emit("payload",u)}parseError(t,n=this.url){return Ge(t,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>ne&&this.events.setMaxListeners(ne)}}export{pt as E,Ue as a,Ot as b,Et as c,ze as d,de as e,vt as f,yt as g,_t as h,nt as i,Xe as j,Rt as k,bt as l,rt as m,ve as n,At as o,Ge as p,mt as q,wt as r,G as s};
//# sourceMappingURL=index.es-6e953a74.js.map
